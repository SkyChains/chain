<<<<<<< HEAD
<<<<<<< HEAD
FROM bufbuild/buf:1.11.0 AS builder
=======
FROM bufbuild/buf:1.9.0 AS builder
>>>>>>> 51f21a85b (Update buf to v1.9.0 (#2239))
=======
FROM bufbuild/buf:1.10.0 AS builder
>>>>>>> 1c0e00460 (Bump buf dependency to v1.10.0 (#2339))

FROM ubuntu:20.04

RUN apt-get update && apt -y install bash curl unzip git
WORKDIR /opt

RUN \
  curl -L https://golang.org/dl/go1.18.5.linux-amd64.tar.gz > golang.tar.gz && \
  mkdir golang && \
  tar -zxvf golang.tar.gz -C golang/

ENV PATH="${PATH}:/opt/golang/go/bin"

COPY --from=builder /usr/local/bin/buf /usr/local/bin/

# any version changes here should also be bumped in scripts/protobuf_codegen.sh
RUN \
  go install google.golang.org/protobuf/cmd/protoc-gen-go@v1.28.1 && \
  go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@v1.2.0

ENV PATH="${PATH}:/root/go/bin/"
